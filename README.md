# Дополнительная функциональность: Администрирование

Ссылка на [пул-реквест](https://github.com/ZherebtsovAA/java-explore-with-me/pull/5)

Второй вариант: "улучшение модерации событий администратором — возможность выгружать все события, ожидающие модерации, 
делать их проверку, а также оставлять комментарий для инициатора события, если оно не прошло модерацию. При этом у инициатора 
есть возможность исправить замечания и отправить событие на повторную модерацию."

Жизненный цикл события следующий:
1. Создание.
2. Ожидание публикации. В статус ожидания публикации событие переходит сразу после создания.
3. Публикация. В это состояние событие переводит администратор.
4. Отмена публикации. В это состояние событие переходит в двух случаях. Первый — если администратор решил, что его нельзя публиковать. 
Второй — когда инициатор события решил отменить его на этапе ожидания публикации.
5. Отмененное администратором событие может быть возвращено на этап модерации администратору владельцем события. 
При отклонении события администратором он может указать причину отклонения. Владелец события должен её исправить и повторно 
направить событие на модерацию. Циклов отклонения заявки администратором может быть несколько.

Что доработано:
1. Возможность выгружать все события, ожидающие модерации, делать их проверку
Эндпоинт: GET /admin/events позволяет найти все события, ожидающие модерации (статус PENDING).
Эндпоинт возвращает List<EventFullDto>.
В класс EventFullDto добавлено поле List<AdminCommentDto> adminComments - список оставленных администратором комментариев 
к отклоненному событию.
public class AdminCommentDto {
   String comment; // комментарий
   LocalDateTime createdOn; // дата и время создания комментария
}

Для публичного эндпоинта GET /events/{id} так же возвращающего объект EventFullDto комментарии администратора не доступны.
Эндпоинты для авторизованных пользователей (владельца события) и для администратора, возвращающие объекты EventFullDto 
при наличии комментариев администратора их возвращают.

2. Оставлять комментарий для инициатора события, если оно не прошло модерацию
Эндпоинт: PATCH /admin/events/{eventId}
В класс UpdateEventAdminRequest добавлено поле "comment" (не обязательное) - комментарий администратора к отклоняемому событию.
Циклов отклонения события может быть несколько, в класс Event добавлено поле List<AdminComment> adminComments содержащее 
комментарии администратора. Поле adminComments будет содержать столько комментариев, сколько раз администратор их укажет 
при отклонении заявки. Создана таблица admin_comments_event и индекс index_ace_event_id по полю event_id хранящая информацию 
об оставленных администратором комментариях к событию.
Комментарий администратора сохраняется в таблицу только при статусе "REJECT_EVENT" - событие отклонено администратором.

3. У инициатора есть возможность исправить замечания и отправить событие на повторную модерацию
Эндпоинт: GET /users/{userId}/events/{eventId} позволяет владельцу события получить подробную информацию о событии, 
в том числе просмотреть комментарии, оставленные администратором. Возвращает объект EventFullDto.

4. Эндпоинт PATCH /users/{userId}/events/{eventId} позволяет исправить замечания администратора и повторно отправить 
событие на модерацию.